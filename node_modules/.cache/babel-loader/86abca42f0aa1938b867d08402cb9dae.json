{"ast":null,"code":"import React from 'react';\nimport * as THREE from \"three\";\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js'; // import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\n// import fragment from \"./shader/fragment.glsl\";\n// import vertex from \"./shader/vertex.glsl‚Äù;\n//\n\nimport * as dat from \"dat.gui\";\nimport gsap from \"gsap\";\nimport map from './earth-dark.jpg';\nlet scene;\nlet container;\nlet width;\nlet height;\nlet renderer;\nlet controls;\nlet camera;\nlet isPlaying;\nlet time;\nexport default class Sketch extends React.Component {\n  constructor(options) {\n    scene = new THREE.Scene();\n    container = options.dom;\n    width = this.container.offsetWidth;\n    height = this.container.offsetHeight;\n    renderer = new THREE.WebGLRenderer();\n    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n    renderer.setSize(this.width, this.height);\n    renderer.setClearColor(0xeeeeee, 1);\n    container.appendChild(this.renderer.domElement);\n    camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.001, 1000); // var frustumSize = 10;\n    // var aspect = window.innerWidth / window.innerHeight;\n    // this.camera = new THREE.OrthographicCamera( frustumSize * aspect / - 2, frustumSize * aspect / 2, frustumSize / 2, frustumSize / - 2, -1000, 1000 );\n\n    camera.position.set(0, 0, 2);\n    controls = new OrbitControls(this.camera, this.renderer.domElement);\n    time = 0;\n    isPlaying = true;\n    this.addObjects();\n    this.resize();\n    this.render();\n    this.setupResize(); // this.settings();\n  }\n\n  settings() {\n    let that = this;\n    this.settings = {\n      progress: 0\n    };\n    this.gui = new dat.GUI();\n    this.gui.add(this.settings, \"progress\", 0, 1, 0.01);\n  }\n\n  setupResize() {\n    window.addEventListener(\"resize\", this.resize.bind(this));\n  }\n\n  resize() {\n    this.width = this.container.offsetWidth;\n    this.height = this.container.offsetHeight;\n    this.renderer.setSize(this.width, this.height);\n    this.camera.aspect = this.width / this.height;\n    this.camera.updateProjectionMatrix();\n  }\n\n  addObjects() {\n    let that = this;\n    this.materialShader = new THREE.ShaderMaterial({\n      extensions: {\n        derivatives: \"#extension GL_OES_standard_derivatives : enable\"\n      },\n      side: THREE.DoubleSide,\n      uniforms: {\n        time: {\n          value: 0\n        },\n        resolution: {\n          value: new THREE.Vector4()\n        }\n      },\n      // wireframe: true,\n      transparent: true //   vertexShader: vertex,\n      //   fragmentShader: fragment\n\n    });\n    this.material = new THREE.MeshBasicMaterial({\n      map: new THREE.TextureLoader().load(map)\n    });\n    this.geometry = new THREE.SphereBufferGeometry(1, 30, 30);\n    this.planet = new THREE.Mesh(this.geometry, this.material);\n    this.scene.add(this.planet); // add pin\n\n    let mesh = new THREE.Mesh(new THREE.SphereBufferGeometry(0.03, 20, 20), new THREE.MeshBasicMaterial({\n      color: 0xff0000\n    }));\n    let mesh1 = new THREE.Mesh(new THREE.SphereBufferGeometry(0.03, 20, 20), new THREE.MeshBasicMaterial({\n      color: 0x00ff00\n    }));\n    let mesh2 = mesh1.clone(); // @todo VITE!!\n    // let lat = 15.6677 * Math.PI/180;\n    // let lng = 96.5545 * Math.PI/180;\n    // WRONG\n\n    function convertLatLngToCartesian(p) {\n      let lat = p.lat * Math.PI / 180;\n      let lng = (180 + p.lng) * Math.PI / 180;\n      let x = Math.sin(lat) * Math.sin(lng);\n      let y = Math.sin(lat) * Math.cos(lng);\n      let z = Math.cos(lat);\n      return {\n        x,\n        y,\n        z\n      };\n    } // RIGHT!!!!\n\n\n    function calcPosFromLatLonRad(lat, lon) {\n      var phi = lat * (Math.PI / 180);\n      var theta = (lon + 180) * (Math.PI / 180);\n      let x = -(Math.cos(phi) * Math.cos(theta));\n      let z = Math.cos(phi) * Math.sin(theta);\n      let y = Math.sin(phi);\n      return {\n        x,\n        y,\n        z\n      };\n    } // let point2 = {\n    //   lat:  34.0522,\n    //   lng: -118.2437\n    // }\n    // let point2 = {\n    //   lat: -23.6345,\n    //   lng: 102.5528\n    // }\n\n\n    let point1 = {\n      lat: 50.4501,\n      lng: 30.5234\n    };\n    let point2 = {\n      lat: 25.3548,\n      lng: 51.1839\n    };\n    let point3 = {\n      lat: 41.8781,\n      lng: -87.6298\n    }; // Dallas\n\n    let point4 = {\n      lat: 32.7767,\n      lng: -96.7970\n    }; // Cancun\n\n    let point5 = {\n      lat: 21.1619,\n      lng: -86.8515\n    }; // Puerto Escondido\n\n    let point6 = {\n      lat: 15.8720,\n      lng: -97.0767\n    };\n    let flight = [point1, point2, point3, point4, point5, point6];\n\n    for (var i = 0; i < flight.length; i++) {\n      let pos = calcPosFromLatLonRad(flight[i].lat, flight[i].lng);\n      let mesh = new THREE.Mesh(new THREE.SphereBufferGeometry(0.03, 20, 20), new THREE.MeshBasicMaterial({\n        color: 0xff0000\n      }) // this.material\n      );\n      mesh.position.set(pos.x, pos.y, pos.z);\n      this.scene.add(mesh);\n\n      if (i < flight.length - 1) {\n        let pos1 = calcPosFromLatLonRad(flight[i + 1].lat, flight[i + 1].lng);\n        this.getCurve(pos, pos1);\n      }\n    }\n  }\n\n  getCurve(p1, p2) {\n    let v1 = new THREE.Vector3(p1.x, p1.y, p1.z);\n    let v2 = new THREE.Vector3(p2.x, p2.y, p2.z);\n    let points = [];\n\n    for (let i = 0; i <= 20; i++) {\n      let p = new THREE.Vector3().lerpVectors(v1, v2, i / 20);\n      p.normalize();\n      p.multiplyScalar(1 + 0.04 * Math.sin(Math.PI * i / 20));\n      points.push(p);\n    }\n\n    let path = new THREE.CatmullRomCurve3(points);\n    const geometry = new THREE.TubeGeometry(path, 20, 0.005, 8, false);\n    const material = this.materialShader;\n    const mesh = new THREE.Mesh(geometry, material);\n    this.scene.add(mesh);\n  }\n\n  stop() {\n    this.isPlaying = false;\n  }\n\n  play() {\n    if (!this.isPlaying) {\n      this.render();\n      this.isPlaying = true;\n    }\n  }\n\n  render() {\n    if (!this.isPlaying) return;\n    this.time += 0.05;\n    this.scene.rotation.y = -this.time / 30;\n    this.materialShader.uniforms.time.value = this.time;\n    requestAnimationFrame(this.render.bind(this));\n    this.renderer.render(this.scene, this.camera);\n  }\n\n}\nnew Sketch({\n  dom: document.getElementById(\"container\")\n});","map":{"version":3,"sources":["/Users/drewstephenson/Documents/3DPortIntel/src/Sketch.js"],"names":["React","THREE","OrbitControls","dat","gsap","map","scene","container","width","height","renderer","controls","camera","isPlaying","time","Sketch","Component","constructor","options","Scene","dom","offsetWidth","offsetHeight","WebGLRenderer","setPixelRatio","Math","min","window","devicePixelRatio","setSize","setClearColor","appendChild","domElement","PerspectiveCamera","innerWidth","innerHeight","position","set","addObjects","resize","render","setupResize","settings","that","progress","gui","GUI","add","addEventListener","bind","aspect","updateProjectionMatrix","materialShader","ShaderMaterial","extensions","derivatives","side","DoubleSide","uniforms","value","resolution","Vector4","transparent","material","MeshBasicMaterial","TextureLoader","load","geometry","SphereBufferGeometry","planet","Mesh","mesh","color","mesh1","mesh2","clone","convertLatLngToCartesian","p","lat","PI","lng","x","sin","y","cos","z","calcPosFromLatLonRad","lon","phi","theta","point1","point2","point3","point4","point5","point6","flight","i","length","pos","pos1","getCurve","p1","p2","v1","Vector3","v2","points","lerpVectors","normalize","multiplyScalar","push","path","CatmullRomCurve3","TubeGeometry","stop","play","rotation","requestAnimationFrame","document","getElementById"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as THREE from \"three\";\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\n// import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\n\n// import fragment from \"./shader/fragment.glsl\";\n// import vertex from \"./shader/vertex.glsl‚Äù;\n\n//\n\nimport * as dat from \"dat.gui\";\nimport gsap from \"gsap\";\n\nimport map from './earth-dark.jpg';\n\n\nlet scene;\nlet container;\nlet width;\nlet height;\nlet renderer;\nlet controls;\nlet camera;\nlet isPlaying;\nlet time;\n\nexport default class Sketch extends React.Component {\n\n\n  constructor(options) {\n    scene = new THREE.Scene();\n\n    container = options.dom;\n    width = this.container.offsetWidth;\n    height = this.container.offsetHeight;\n    renderer = new THREE.WebGLRenderer();\n    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\n    renderer.setSize(this.width, this.height);\n    renderer.setClearColor(0xeeeeee, 1); \n\n    container.appendChild(this.renderer.domElement);\n\n    camera = new THREE.PerspectiveCamera(\n      70,\n      window.innerWidth / window.innerHeight,\n      0.001,\n      1000\n    );\n\n    // var frustumSize = 10;\n    // var aspect = window.innerWidth / window.innerHeight;\n    // this.camera = new THREE.OrthographicCamera( frustumSize * aspect / - 2, frustumSize * aspect / 2, frustumSize / 2, frustumSize / - 2, -1000, 1000 );\n    camera.position.set(0, 0, 2);\n    controls = new OrbitControls(this.camera, this.renderer.domElement);\n    time = 0;\n\n    isPlaying = true;\n    \n    this.addObjects();\n    this.resize();\n    this.render();\n    this.setupResize();\n    // this.settings();\n  }\n\n  settings() {\n    let that = this;\n    this.settings = {\n      progress: 0,\n    };\n    this.gui = new dat.GUI();\n    this.gui.add(this.settings, \"progress\", 0, 1, 0.01);\n  }\n\n  setupResize() {\n    window.addEventListener(\"resize\", this.resize.bind(this));\n  }\n\n  resize() {\n    this.width = this.container.offsetWidth;\n    this.height = this.container.offsetHeight;\n    this.renderer.setSize(this.width, this.height);\n    this.camera.aspect = this.width / this.height;\n    this.camera.updateProjectionMatrix();\n  }\n\n  addObjects() {\n    let that = this;\n    this.materialShader = new THREE.ShaderMaterial({\n      extensions: {\n        derivatives: \"#extension GL_OES_standard_derivatives : enable\"\n      },\n      side: THREE.DoubleSide,\n      uniforms: {\n        time: { value: 0 },\n        resolution: { value: new THREE.Vector4() },\n      },\n      // wireframe: true,\n      transparent: true,\n    //   vertexShader: vertex,\n    //   fragmentShader: fragment\n    });\n\n    this.material = new THREE.MeshBasicMaterial({\n      map: new THREE.TextureLoader().load(map)\n    })\n\n    this.geometry = new THREE.SphereBufferGeometry(1, 30,30);\n\n    this.planet = new THREE.Mesh(this.geometry, this.material);\n    this.scene.add(this.planet);\n\n    // add pin\n\n    let mesh = new THREE.Mesh(\n      new THREE.SphereBufferGeometry(0.03,20,20),\n      new THREE.MeshBasicMaterial({color:0xff0000})\n    )\n    let mesh1 = new THREE.Mesh(\n      new THREE.SphereBufferGeometry(0.03,20,20),\n      new THREE.MeshBasicMaterial({color:0x00ff00})\n    )\n\n    let mesh2 = mesh1.clone();\n\n    // @todo VITE!!\n    // let lat = 15.6677 * Math.PI/180;\n    // let lng = 96.5545 * Math.PI/180;\n\n\n    // WRONG\n    function convertLatLngToCartesian(p){\n      let lat = (p.lat) * Math.PI/180;\n      let lng = (180+p.lng) * Math.PI/180;\n      let x = Math.sin(lat)*Math.sin(lng)\n      let y = Math.sin(lat)*Math.cos(lng)\n      let z = Math.cos(lat)\n      return {\n        x,y,z\n      }\n\n    }\n\n    // RIGHT!!!!\n    function calcPosFromLatLonRad(lat,lon) {\n      var phi   = (lat)*(Math.PI/180);\n      var theta = (lon+180)*(Math.PI/180);\n      let x = -(Math.cos(phi)*Math.cos(theta));\n      let z = ( Math.cos(phi)*Math.sin(theta));\n      let y = ( Math.sin(phi));\n      return {x,y,z};\n    }\n\n    // let point2 = {\n    //   lat:  34.0522,\n    //   lng: -118.2437\n    // }\n\n    // let point2 = {\n    //   lat: -23.6345,\n    //   lng: 102.5528\n    // }\n\n    let point1 = {\n      lat: 50.4501,\n      lng: 30.5234\n    }\n\n    let point2 = {\n      lat: 25.3548,\n      lng: 51.1839,\n    }\n\n    let point3 = {\n      lat: 41.8781,\n      lng: -87.6298,\n    }\n    // Dallas\n    let point4 = {\n      lat: 32.7767,\n      lng: -96.7970,\n    }\n    // Cancun\n    let point5 = {\n      lat: 21.1619,\n      lng: -86.8515,\n    }\n\n    // Puerto Escondido\n    let point6 = {\n      lat: 15.8720,\n      lng: -97.0767,\n    }\n\n    let flight = [\n      point1,\n      point2,\n      point3,\n      point4,\n      point5,\n      point6,\n    ]\n\n\n    for (var i = 0; i < flight.length; i++) {\n      let pos = calcPosFromLatLonRad(flight[i].lat,flight[i].lng);\n      \n      let mesh = new THREE.Mesh(\n        new THREE.SphereBufferGeometry(0.03,20,20),\n        new THREE.MeshBasicMaterial({color:0xff0000})\n        // this.material\n      )\n      mesh.position.set(pos.x,pos.y,pos.z)\n      this.scene.add(mesh);\n      if(i<flight.length-1){\n        let pos1 = calcPosFromLatLonRad(flight[i+1].lat,flight[i+1].lng);\n        this.getCurve(pos,pos1)\n      }\n      \n    }\n\n\n  }\n\n\n  getCurve(p1,p2){\n    let v1 = new THREE.Vector3(p1.x,p1.y,p1.z);\n    let v2 = new THREE.Vector3(p2.x,p2.y,p2.z);\n    let points = []\n    for (let i = 0; i <=20; i++) {\n      let p = new THREE.Vector3().lerpVectors(v1,v2, i/20)\n      p.normalize()\n      p.multiplyScalar(1 + 0.04*Math.sin(Math.PI*i/20));\n      points.push(p)\n    }\n\n    let path = new THREE.CatmullRomCurve3(points);\n\n\n\n    const geometry = new THREE.TubeGeometry( path, 20, 0.005, 8, false );\n    const material = this.materialShader\n    const mesh = new THREE.Mesh( geometry, material );\n    this.scene.add( mesh );\n\n  }\n\n\n  stop() {\n    this.isPlaying = false;\n  }\n\n  play() {\n    if(!this.isPlaying){\n      this.render()\n      this.isPlaying = true;\n    }\n  }\n\n  render() {\n    if (!this.isPlaying) return;\n    this.time += 0.05;\n    this.scene.rotation.y = -this.time/30\n    this.materialShader.uniforms.time.value = this.time;\n    requestAnimationFrame(this.render.bind(this));\n    this.renderer.render(this.scene, this.camera);\n  }\n}\n\nnew Sketch({\n  dom: document.getElementById(\"container\")\n});\n"]},"metadata":{},"sourceType":"module"}